# æ´ªæ°´è½¦è¾†æ£€æµ‹ç³»ç»Ÿ - å®Œæ•´ç³»ç»Ÿæ–‡æ¡£

## ğŸ“‹ ç›®å½•

1. [ç³»ç»Ÿæ¦‚è¿°](#ç³»ç»Ÿæ¦‚è¿°)
2. [æ ¸å¿ƒåŠŸèƒ½](#æ ¸å¿ƒåŠŸèƒ½)
3. [ç³»ç»Ÿæ¶æ„](#ç³»ç»Ÿæ¶æ„)
4. [æŠ€æœ¯æ ˆ](#æŠ€æœ¯æ ˆ)
5. [å®‰è£…éƒ¨ç½²](#å®‰è£…éƒ¨ç½²)
6. [ç”¨æˆ·æŒ‡å—](#ç”¨æˆ·æŒ‡å—)
7. [å¼€å‘æŒ‡å—](#å¼€å‘æŒ‡å—)
8. [APIæ–‡æ¡£](#apiæ–‡æ¡£)
9. [æ•…éšœæ’é™¤](#æ•…éšœæ’é™¤)
10. [æ›´æ–°æ—¥å¿—](#æ›´æ–°æ—¥å¿—)

---

## ğŸŒŠ ç³»ç»Ÿæ¦‚è¿°

æ´ªæ°´è½¦è¾†æ£€æµ‹ç³»ç»Ÿæ˜¯ä¸€ä¸ªåŸºäºæ·±åº¦å­¦ä¹ çš„æ™ºèƒ½åˆ†æå¹³å°ï¼Œä¸“é—¨ç”¨äºæ£€æµ‹å’Œåˆ†ææ´ªæ°´ç¯å¢ƒä¸­çš„è½¦è¾†æ·¹æ²¡æƒ…å†µã€‚ç³»ç»Ÿé‡‡ç”¨å…ˆè¿›çš„è®¡ç®—æœºè§†è§‰æŠ€æœ¯ï¼Œèƒ½å¤Ÿè‡ªåŠ¨è¯†åˆ«å›¾åƒä¸­çš„è½¦è¾†å’Œæ°´é¢åŒºåŸŸï¼Œå¹¶å‡†ç¡®è¯„ä¼°è½¦è¾†çš„æ·¹æ²¡ç¨‹åº¦ã€‚

### ğŸ¯ åº”ç”¨åœºæ™¯

- **ç¾å®³è¯„ä¼°**: æ´ªæ°´ç¾å®³åçš„è½¦è¾†æŸå¤±è¯„ä¼°
- **ä¿é™©ç†èµ”**: è½¦è¾†æ¶‰æ°´æŸå¤±çš„å®¢è§‚è¯„ä¼°
- **åº”æ€¥å“åº”**: å®æ—¶ç›‘æ§æ´ªæ°´åŒºåŸŸçš„è½¦è¾†å®‰å…¨çŠ¶å†µ
- **åŸå¸‚è§„åˆ’**: åˆ†æåŸå¸‚æ’æ°´ç³»ç»Ÿçš„æœ‰æ•ˆæ€§
- **ç ”ç©¶åˆ†æ**: æ´ªæ°´å¯¹äº¤é€šå·¥å…·å½±å“çš„å­¦æœ¯ç ”ç©¶

### ğŸ† ç³»ç»Ÿä¼˜åŠ¿

- **é«˜ç²¾åº¦æ£€æµ‹**: é‡‡ç”¨YOLOv11å’ŒRT-DETRç­‰å…ˆè¿›æ¨¡å‹
- **å¤šæ¨¡æ€åˆ†æ**: ç»“åˆè½¦è¾†æ£€æµ‹å’Œæ°´é¢åˆ†å‰²æŠ€æœ¯
- **æ™ºèƒ½è¯„ä¼°**: è‡ªåŠ¨è®¡ç®—è½¦è¾†æ·¹æ²¡ç­‰çº§å’Œé£é™©ç¨‹åº¦
- **ç”¨æˆ·å‹å¥½**: ç›´è§‚çš„å›¾å½¢ç•Œé¢å’Œæ‰¹é‡å¤„ç†åŠŸèƒ½
- **è·¨å¹³å°æ”¯æŒ**: æ¡Œé¢åº”ç”¨å’ŒWebåº”ç”¨åŒé‡éƒ¨ç½²

---

## ğŸš€ æ ¸å¿ƒåŠŸèƒ½

### 1. è½¦è¾†æ£€æµ‹æ¨¡å—

#### æ”¯æŒçš„æ¨¡å‹
- **YOLOv11 Car Detection**: æœ€æ–°çš„YOLOæ¶æ„ï¼Œæ£€æµ‹é€Ÿåº¦å¿«ï¼Œç²¾åº¦é«˜
- **RT-DETR Car Detection**: åŸºäºTransformerçš„æ£€æµ‹å™¨ï¼Œé€‚åˆå¤æ‚åœºæ™¯

#### æ£€æµ‹èƒ½åŠ›
- å¤šç§è½¦è¾†ç±»å‹ï¼šè½¿è½¦ã€SUVã€å¡è½¦ã€æ‘©æ‰˜è½¦ç­‰
- å¤æ‚ç¯å¢ƒé€‚åº”ï¼šé›¨å¤©ã€å¤œæ™šã€é®æŒ¡ç­‰æ¡ä»¶
- å®æ—¶æ£€æµ‹ï¼šå•å¼ å›¾ç‰‡å¤„ç†æ—¶é—´ < 1ç§’

### 2. æ°´é¢åˆ†å‰²æ¨¡å—

#### æ”¯æŒçš„æ¨¡å‹
- **DeepLabV3 Water Segmentation**: åŸºäºResNetçš„è¯­ä¹‰åˆ†å‰²ç½‘ç»œ
- **YOLOv11 Water Segmentation**: YOLOæ¶æ„çš„åˆ†å‰²ç‰ˆæœ¬

#### åˆ†å‰²ç²¾åº¦
- åƒç´ çº§æ°´é¢è¯†åˆ«
- å¤æ‚æ°´é¢å½¢çŠ¶å¤„ç†
- åå°„å’Œæ³¢çº¹ç¯å¢ƒé€‚åº”

### 3. æ·¹æ²¡åˆ†æå¼•æ“

#### æ·¹æ²¡ç­‰çº§è¯„ä¼°
- **è½®èƒçº§ (Wheel Level)**: æ°´ä½åˆ°è¾¾è½®èƒé«˜åº¦
- **è½¦é—¨çº§ (Door Level)**: æ°´ä½åˆ°è¾¾è½¦é—¨é«˜åº¦  
- **è½¦çª—çº§ (Window Level)**: æ°´ä½åˆ°è¾¾è½¦çª—é«˜åº¦

#### åˆ†ææŒ‡æ ‡
- è½¦è¾†æ•°é‡ç»Ÿè®¡
- æ·¹æ²¡ç­‰çº§åˆ†å¸ƒ
- æ°´é¢è¦†ç›–ç‡
- é£é™©è¯„ä¼°æŠ¥å‘Š

### 4. æ‰¹é‡å¤„ç†åŠŸèƒ½

#### æ‰¹é‡åˆ†æ
- å¤šå›¾ç‰‡åŒæ—¶å¤„ç†
- è¿›åº¦å®æ—¶æ˜¾ç¤º
- é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶
- ç»“æœç»Ÿä¸€ç®¡ç†

#### æ‰¹é‡ä¸‹è½½
- é€‰æ‹©æ€§æ‰¹é‡ä¸‹è½½
- æ™ºèƒ½æ–‡ä»¶å‘½å
- è¿›åº¦è·Ÿè¸ª
- é”™è¯¯æŠ¥å‘Š

### 5. ç»“æœå¯è§†åŒ–

#### æ£€æµ‹ç»“æœå±•ç¤º
- è½¦è¾†è¾¹ç•Œæ¡†æ ‡æ³¨
- æ·¹æ²¡ç­‰çº§é¢œè‰²ç¼–ç 
- æ°´é¢åŒºåŸŸé«˜äº®æ˜¾ç¤º
- ç»Ÿè®¡ä¿¡æ¯é¢æ¿

#### å¯¼å‡ºåŠŸèƒ½
- é«˜è´¨é‡ç»“æœå›¾åƒ
- è¯¦ç»†åˆ†ææŠ¥å‘Š
- æ•°æ®ç»Ÿè®¡è¡¨æ ¼
- æ‰¹é‡å¯¼å‡ºæ”¯æŒ

---

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ´ªæ°´è½¦è¾†æ£€æµ‹ç³»ç»Ÿ                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ç”¨æˆ·ç•Œé¢å±‚ (UI Layer)                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   æ¡Œé¢åº”ç”¨      â”‚    â”‚        Webåº”ç”¨                  â”‚ â”‚
â”‚  â”‚   (PyQt6)       â”‚    â”‚  Frontend: React + TypeScript  â”‚ â”‚
â”‚  â”‚                 â”‚    â”‚  Backend: FastAPI + Uvicorn    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ä¸šåŠ¡é€»è¾‘å±‚ (Business Logic Layer)                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  åˆ†ææ§åˆ¶å™¨     â”‚    â”‚      æ–‡ä»¶æ“ä½œç®¡ç†å™¨             â”‚ â”‚
â”‚  â”‚ AnalysisControllerâ”‚   â”‚    FileOperations              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ ¸å¿ƒå¼•æ“å±‚ (Core Engine Layer)                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ æ¨¡å‹ç®¡ç†å™¨  â”‚ â”‚ å›¾åƒå¤„ç†å™¨  â”‚ â”‚    æ´ªæ°´åˆ†æå™¨           â”‚ â”‚
â”‚  â”‚ModelManager â”‚ â”‚ImageProcessorâ”‚ â”‚   FloodAnalyzer        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              å¯è§†åŒ–å¼•æ“ (VisualizationEngine)           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ•°æ®å±‚ (Data Layer)                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  AIæ¨¡å‹     â”‚ â”‚  é…ç½®æ–‡ä»¶   â”‚ â”‚      ç¼“å­˜ç³»ç»Ÿ           â”‚ â”‚
â”‚  â”‚  Models     â”‚ â”‚   Config    â”‚ â”‚   Analysis Cache       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒæ¨¡å—è¯¦è§£

#### 1. æ¨¡å‹ç®¡ç†å™¨ (ModelManager)
```python
class ModelManager:
    """AIæ¨¡å‹ç»Ÿä¸€ç®¡ç†"""
    - æ¨¡å‹åŠ è½½å’Œåˆå§‹åŒ–
    - æ¨ç†å¼•æ“ç®¡ç†
    - æ€§èƒ½ä¼˜åŒ– (GPU/CPU)
    - æ¨¡å‹åˆ‡æ¢å’Œé…ç½®
```

#### 2. å›¾åƒå¤„ç†å™¨ (ImageProcessor)
```python
class ImageProcessor:
    """å›¾åƒå¤„ç†æ ¸å¿ƒ"""
    - å›¾åƒåŠ è½½å’Œé¢„å¤„ç†
    - æ ¼å¼è½¬æ¢å’Œå°ºå¯¸è°ƒæ•´
    - æ•°æ®å¢å¼ºå’Œæ ‡å‡†åŒ–
    - ç»“æœåå¤„ç†
```

#### 3. æ´ªæ°´åˆ†æå™¨ (FloodAnalyzer)
```python
class FloodAnalyzer:
    """æ´ªæ°´æ·¹æ²¡åˆ†æ"""
    - è½¦è¾†-æ°´é¢é‡å è®¡ç®—
    - æ·¹æ²¡ç­‰çº§è¯„ä¼°
    - é£é™©ç¨‹åº¦åˆ†æ
    - ç»Ÿè®¡æ•°æ®ç”Ÿæˆ
```

#### 4. å¯è§†åŒ–å¼•æ“ (VisualizationEngine)
```python
class VisualizationEngine:
    """ç»“æœå¯è§†åŒ–"""
    - æ£€æµ‹æ¡†ç»˜åˆ¶
    - åˆ†å‰²æ©ç å åŠ 
    - é¢œè‰²ç¼–ç ç³»ç»Ÿ
    - ç»Ÿè®¡å›¾è¡¨ç”Ÿæˆ
```

---

## ğŸ’» æŠ€æœ¯æ ˆ

### æ·±åº¦å­¦ä¹ æ¡†æ¶
- **PyTorch 2.0+**: ä¸»è¦æ·±åº¦å­¦ä¹ æ¡†æ¶
- **Ultralytics**: YOLOv11æ¨¡å‹æ”¯æŒ
- **Torchvision**: é¢„è®­ç»ƒæ¨¡å‹å’Œå˜æ¢

### è®¡ç®—æœºè§†è§‰
- **OpenCV 4.8+**: å›¾åƒå¤„ç†å’Œè®¡ç®—æœºè§†è§‰
- **PIL/Pillow**: å›¾åƒæ–‡ä»¶å¤„ç†
- **NumPy**: æ•°å€¼è®¡ç®—å’Œæ•°ç»„æ“ä½œ

### æ¡Œé¢åº”ç”¨å¼€å‘
- **PyQt6**: ç°ä»£GUIæ¡†æ¶
- **Qt Designer**: ç•Œé¢è®¾è®¡å·¥å…·
- **QThread**: å¤šçº¿ç¨‹å¤„ç†

### Webåº”ç”¨å¼€å‘
- **FastAPI**: é«˜æ€§èƒ½Webæ¡†æ¶
- **Uvicorn**: ASGIæœåŠ¡å™¨
- **React 18**: å‰ç«¯æ¡†æ¶
- **TypeScript**: ç±»å‹å®‰å…¨çš„JavaScript

### éƒ¨ç½²å’Œè¿ç»´
- **Docker**: å®¹å™¨åŒ–éƒ¨ç½²
- **Nginx**: åå‘ä»£ç†å’Œé™æ€æ–‡ä»¶æœåŠ¡
- **Docker Compose**: å¤šå®¹å™¨ç¼–æ’

### å¼€å‘å·¥å…·
- **Git**: ç‰ˆæœ¬æ§åˆ¶
- **pytest**: å•å…ƒæµ‹è¯•
- **Black**: ä»£ç æ ¼å¼åŒ–
- **Flake8**: ä»£ç è´¨é‡æ£€æŸ¥

---

## ğŸ“¦ å®‰è£…éƒ¨ç½²

### ç³»ç»Ÿè¦æ±‚

#### æœ€ä½é…ç½®
- **æ“ä½œç³»ç»Ÿ**: Windows 10/11, macOS 10.15+, Ubuntu 18.04+
- **Python**: 3.8+
- **å†…å­˜**: 8GB RAM
- **å­˜å‚¨**: 5GB å¯ç”¨ç©ºé—´
- **æ˜¾å¡**: æ”¯æŒCUDAçš„NVIDIAæ˜¾å¡ (å¯é€‰)

#### æ¨èé…ç½®
- **æ“ä½œç³»ç»Ÿ**: Windows 11, macOS 12+, Ubuntu 20.04+
- **Python**: 3.9+
- **å†…å­˜**: 16GB RAM
- **å­˜å‚¨**: 10GB å¯ç”¨ç©ºé—´
- **æ˜¾å¡**: NVIDIA RTX 3060 æˆ–æ›´é«˜

### å®‰è£…æ­¥éª¤

#### 1. ç¯å¢ƒå‡†å¤‡
```bash
# å…‹éš†é¡¹ç›®
git clone <repository-url>
cd flood-vehicle-detection-system

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv venv

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
# Windows
venv\Scripts\activate
# macOS/Linux
source venv/bin/activate

# å‡çº§pip
pip install --upgrade pip
```

#### 2. å®‰è£…ä¾èµ–
```bash
# å®‰è£…Pythonä¾èµ–
pip install -r requirements.txt

# å¦‚æœæœ‰GPUæ”¯æŒ
pip install torch torchvision --index-url https://download.pytorch.org/whl/cu118
```

#### 3. æ¨¡å‹æ–‡ä»¶é…ç½®
```bash
# åˆ›å»ºæ¨¡å‹ç›®å½•
mkdir -p models

# ä¸‹è½½é¢„è®­ç»ƒæ¨¡å‹ (è¯·æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´ä¸‹è½½é“¾æ¥)
# å°†ä»¥ä¸‹æ¨¡å‹æ–‡ä»¶æ”¾ç½®åœ¨ models/ ç›®å½•ä¸­ï¼š
# - yolov11_car_detection.pt
# - rtdetr_car_detection.pt  
# - deeplabv3_water.pt
# - yolov11_seg_water.pt
```

#### 4. è¿è¡Œåº”ç”¨

##### æ¡Œé¢ç‰ˆ
```bash
# å¯åŠ¨æ¡Œé¢åº”ç”¨
python main.py

# æˆ–ä½¿ç”¨å¯åŠ¨è„šæœ¬
./start_desktop.sh  # Linux/macOS
start_desktop.bat   # Windows
```

##### Webç‰ˆ
```bash
# å¯åŠ¨Webåç«¯
python -m flood_detection_app.web.backend.main

# WebæœåŠ¡åœ°å€: http://localhost:8000
```

### Dockeréƒ¨ç½²

#### 1. æ„å»ºé•œåƒ
```bash
# æ„å»ºDockeré•œåƒ
docker build -t flood-detection-system .
```

#### 2. è¿è¡Œå®¹å™¨
```bash
# ä½¿ç”¨Docker Compose
docker-compose up -d

# æˆ–ç›´æ¥è¿è¡Œ
docker run -p 8000:8000 flood-detection-system
```

---

## ğŸ“– ç”¨æˆ·æŒ‡å—

### æ¡Œé¢åº”ç”¨ä½¿ç”¨æŒ‡å—

#### 1. å¯åŠ¨åº”ç”¨
- åŒå‡»æ¡Œé¢å¿«æ·æ–¹å¼æˆ–è¿è¡Œ `python main.py`
- ç­‰å¾…æ¨¡å‹åŠ è½½å®Œæˆï¼ˆé¦–æ¬¡å¯åŠ¨éœ€è¦1-2åˆ†é’Ÿï¼‰

#### 2. ä¸Šä¼ å›¾ç‰‡
- **å•å¼ ä¸Šä¼ **: ç‚¹å‡» "Upload Image" æŒ‰é’®é€‰æ‹©å›¾ç‰‡
- **æ‰¹é‡ä¸Šä¼ **: ç‚¹å‡» "Batch Upload" æŒ‰é’®é€‰æ‹©å¤šå¼ å›¾ç‰‡
- **æ”¯æŒæ ¼å¼**: JPG, JPEG, PNG, BMP

#### 3. é…ç½®åˆ†æå‚æ•°
- **ä»»åŠ¡æ¨¡å¼**:
  - `Combined Analysis`: è½¦è¾†æ£€æµ‹ + æ°´é¢åˆ†å‰² (æ¨è)
  - `Vehicle Detection Only`: ä»…è½¦è¾†æ£€æµ‹
  - `Water Segmentation Only`: ä»…æ°´é¢åˆ†å‰²
- **è½¦è¾†æ£€æµ‹æ¨¡å‹**: YOLOv11 æˆ– RT-DETR
- **æ°´é¢åˆ†å‰²æ¨¡å‹**: DeepLabV3 æˆ– YOLOv11

#### 4. æ‰§è¡Œåˆ†æ
- **å•å¼ åˆ†æ**: é€‰æ‹©å›¾ç‰‡åç‚¹å‡» "Analyze" æŒ‰é’®
- **æ‰¹é‡åˆ†æ**: é€‰ä¸­å¤šå¼ å›¾ç‰‡åç‚¹å‡» "Batch Analyze" æŒ‰é’®
- **æŸ¥çœ‹è¿›åº¦**: è¿›åº¦æ¡æ˜¾ç¤ºåˆ†æè¿›åº¦

#### 5. æŸ¥çœ‹ç»“æœ
- **å·¦ä¾§é¢æ¿**: æ˜¾ç¤ºåŸå§‹å›¾ç‰‡
- **å³ä¾§é¢æ¿**: æ˜¾ç¤ºåˆ†æç»“æœ
- **ç»Ÿè®¡é¢æ¿**: æ˜¾ç¤ºè¯¦ç»†ç»Ÿè®¡ä¿¡æ¯
- **åˆ‡æ¢å›¾ç‰‡**: ç‚¹å‡»æ–‡ä»¶åˆ—è¡¨ä¸­çš„å›¾ç‰‡æŸ¥çœ‹ä¸åŒç»“æœ

#### 6. ä¸‹è½½ç»“æœ
- **å•å¼ ä¸‹è½½**: ç‚¹å‡» "Download Result" ä¿å­˜å½“å‰ç»“æœ
- **æ‰¹é‡ä¸‹è½½**: é€‰ä¸­å¤šå¼ å·²åˆ†æå›¾ç‰‡ï¼Œé€‰æ‹©æ‰¹é‡ä¸‹è½½é€‰é¡¹
- **æ–‡ä»¶å‘½å**: è‡ªåŠ¨ç”Ÿæˆ `åŸæ–‡ä»¶å_analysis_result.jpg` æ ¼å¼

### Webåº”ç”¨ä½¿ç”¨æŒ‡å—

#### 1. è®¿é—®ç³»ç»Ÿ
- æ‰“å¼€æµè§ˆå™¨è®¿é—® `http://localhost:8000`
- ç³»ç»Ÿä¼šè‡ªåŠ¨åŠ è½½ç”¨æˆ·ç•Œé¢

#### 2. APIæ¥å£ä½¿ç”¨
```python
import requests

# ä¸Šä¼ å›¾ç‰‡è¿›è¡Œåˆ†æ
files = {'file': open('test_image.jpg', 'rb')}
response = requests.post('http://localhost:8000/api/analyze', files=files)
result = response.json()
```

---

## ğŸ› ï¸ å¼€å‘æŒ‡å—

### é¡¹ç›®ç»“æ„è¯¦è§£

```
flood_detection_app/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ main.py                     # åº”ç”¨ç¨‹åºå…¥å£
â”œâ”€â”€ core/                       # æ ¸å¿ƒå¼•æ“æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ config.py              # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ data_models.py         # æ•°æ®æ¨¡å‹å®šä¹‰
â”‚   â”œâ”€â”€ exceptions.py          # å¼‚å¸¸å¤„ç†
â”‚   â”œâ”€â”€ flood_analyzer.py      # æ´ªæ°´åˆ†æå™¨
â”‚   â”œâ”€â”€ image_processor.py     # å›¾åƒå¤„ç†å™¨
â”‚   â”œâ”€â”€ model_manager.py       # æ¨¡å‹ç®¡ç†å™¨
â”‚   â””â”€â”€ visualization_engine.py # å¯è§†åŒ–å¼•æ“
â”œâ”€â”€ desktop/                   # æ¡Œé¢åº”ç”¨æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ main_window.py         # ä¸»çª—å£
â”‚   â”œâ”€â”€ analysis_controller.py # åˆ†ææ§åˆ¶å™¨
â”‚   â”œâ”€â”€ file_operations.py     # æ–‡ä»¶æ“ä½œ
â”‚   â”œâ”€â”€ image_display_widget.py # å›¾åƒæ˜¾ç¤ºç»„ä»¶
â”‚   â””â”€â”€ statistics_widget.py   # ç»Ÿè®¡ç»„ä»¶
â”œâ”€â”€ web/                       # Webåº”ç”¨æ¨¡å—
â”‚   â”œâ”€â”€ backend/               # åç«¯API
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ main.py           # FastAPIåº”ç”¨
â”‚   â”‚   â”œâ”€â”€ routes/           # APIè·¯ç”±
â”‚   â”‚   â””â”€â”€ models/           # æ•°æ®æ¨¡å‹
â”‚   â””â”€â”€ frontend/             # å‰ç«¯åº”ç”¨
â”‚       â”œâ”€â”€ src/
â”‚       â”œâ”€â”€ public/
â”‚       â””â”€â”€ package.json
â””â”€â”€ tests/                     # æµ‹è¯•æ¨¡å—
    â”œâ”€â”€ __init__.py
    â”œâ”€â”€ test_core/
    â”œâ”€â”€ test_desktop/
    â””â”€â”€ test_web/
```

### æ ¸å¿ƒç±»è®¾è®¡

#### 1. æ•°æ®æ¨¡å‹ (data_models.py)
```python
@dataclass
class Detection:
    """æ£€æµ‹ç»“æœ"""
    bbox: Tuple[float, float, float, float]  # x1, y1, x2, y2
    confidence: float
    class_id: int
    class_name: str

@dataclass
class VehicleResult:
    """è½¦è¾†åˆ†æç»“æœ"""
    detection: Detection
    flood_level: FloodLevel
    overlap_ratio: float
    vehicle_id: int

@dataclass
class AnalysisResult:
    """å®Œæ•´åˆ†æç»“æœ"""
    vehicles: List[VehicleResult]
    water_mask: np.ndarray
    statistics: Statistics
    original_image_shape: Tuple[int, int]
```

#### 2. é…ç½®ç®¡ç† (config.py)
```python
class ConfigManager:
    """é…ç½®ç®¡ç†å™¨"""
    
    def __init__(self):
        self._config = None
        self._load_default_config()
    
    def get_model_config(self, model_name: str) -> ModelConfig:
        """è·å–æ¨¡å‹é…ç½®"""
        
    def update_config(self, new_config: AppConfig):
        """æ›´æ–°é…ç½®"""
```

### æ·»åŠ æ–°åŠŸèƒ½

#### 1. æ·»åŠ æ–°çš„æ£€æµ‹æ¨¡å‹
```python
# 1. åœ¨ config.py ä¸­æ·»åŠ æ¨¡å‹é…ç½®
new_model = ModelConfig(
    name="New Detection Model",
    file_path="models/new_model.pt",
    input_size=(640, 640),
    confidence_threshold=0.5,
    nms_threshold=0.4
)

# 2. åœ¨ model_manager.py ä¸­æ·»åŠ åŠ è½½é€»è¾‘
def load_new_model(self, model_path: str):
    # æ¨¡å‹åŠ è½½å®ç°
    pass

# 3. æ›´æ–°UIç»„ä»¶ä»¥æ”¯æŒæ–°æ¨¡å‹
```

#### 2. æ·»åŠ æ–°çš„åˆ†ææŒ‡æ ‡
```python
# 1. åœ¨ data_models.py ä¸­æ‰©å±•Statisticsç±»
@dataclass
class Statistics:
    # ç°æœ‰å­—æ®µ...
    new_metric: float = 0.0

# 2. åœ¨ flood_analyzer.py ä¸­å®ç°è®¡ç®—é€»è¾‘
def calculate_new_metric(self, vehicles, water_mask):
    # è®¡ç®—å®ç°
    pass

# 3. æ›´æ–°å¯è§†åŒ–ç»„ä»¶æ˜¾ç¤ºæ–°æŒ‡æ ‡
```

### æµ‹è¯•æŒ‡å—

#### è¿è¡Œæµ‹è¯•
```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
pytest

# è¿è¡Œç‰¹å®šæ¨¡å—æµ‹è¯•
pytest tests/test_core/

# è¿è¡Œè¦†ç›–ç‡æµ‹è¯•
pytest --cov=flood_detection_app

# ç”ŸæˆHTMLè¦†ç›–ç‡æŠ¥å‘Š
pytest --cov=flood_detection_app --cov-report=html
```

#### ç¼–å†™æµ‹è¯•
```python
import pytest
from flood_detection_app.core.model_manager import ModelManager

class TestModelManager:
    def test_model_loading(self):
        manager = ModelManager()
        assert manager.vehicle_models is not None
        
    def test_prediction(self):
        # æµ‹è¯•é¢„æµ‹åŠŸèƒ½
        pass
```

---

## ğŸ“¡ APIæ–‡æ¡£

### REST APIæ¥å£

#### 1. å›¾ç‰‡åˆ†ææ¥å£
```http
POST /api/analyze
Content-Type: multipart/form-data

Parameters:
- file: å›¾ç‰‡æ–‡ä»¶ (required)
- task_mode: åˆ†ææ¨¡å¼ (optional, default: "combined")
- vehicle_model: è½¦è¾†æ£€æµ‹æ¨¡å‹ (optional)
- water_model: æ°´é¢åˆ†å‰²æ¨¡å‹ (optional)

Response:
{
    "success": true,
    "data": {
        "vehicles": [...],
        "statistics": {...},
        "result_image_url": "..."
    }
}
```

#### 2. æ‰¹é‡åˆ†ææ¥å£
```http
POST /api/batch-analyze
Content-Type: multipart/form-data

Parameters:
- files: å¤šä¸ªå›¾ç‰‡æ–‡ä»¶ (required)
- task_mode: åˆ†ææ¨¡å¼ (optional)

Response:
{
    "success": true,
    "data": {
        "results": [...],
        "summary": {...}
    }
}
```

#### 3. æ¨¡å‹ä¿¡æ¯æ¥å£
```http
GET /api/models

Response:
{
    "vehicle_models": [...],
    "water_models": [...]
}
```

### WebSocketæ¥å£

#### å®æ—¶åˆ†æè¿›åº¦
```javascript
const ws = new WebSocket('ws://localhost:8000/ws/analysis');

ws.onmessage = function(event) {
    const data = JSON.parse(event.data);
    console.log('Progress:', data.progress);
};
```

---

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. æ¨¡å‹åŠ è½½å¤±è´¥
**é—®é¢˜**: `FileNotFoundError: Model file not found`
**è§£å†³æ–¹æ¡ˆ**:
- æ£€æŸ¥æ¨¡å‹æ–‡ä»¶æ˜¯å¦å­˜åœ¨äº `models/` ç›®å½•
- éªŒè¯æ–‡ä»¶è·¯å¾„é…ç½®æ˜¯å¦æ­£ç¡®
- ç¡®ä¿æ¨¡å‹æ–‡ä»¶å®Œæ•´ä¸‹è½½

#### 2. GPUå†…å­˜ä¸è¶³
**é—®é¢˜**: `CUDA out of memory`
**è§£å†³æ–¹æ¡ˆ**:
- å‡å°è¾“å…¥å›¾åƒå°ºå¯¸
- é™ä½æ‰¹å¤„ç†å¤§å°
- åˆ‡æ¢åˆ°CPUæ¨¡å¼

#### 3. ä¾èµ–åŒ…å†²çª
**é—®é¢˜**: `ImportError` æˆ–ç‰ˆæœ¬å†²çª
**è§£å†³æ–¹æ¡ˆ**:
```bash
# é‡æ–°åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
rm -rf venv
python -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```

#### 4. PyQt6æ˜¾ç¤ºé—®é¢˜
**é—®é¢˜**: GUIç•Œé¢æ˜¾ç¤ºå¼‚å¸¸
**è§£å†³æ–¹æ¡ˆ**:
```bash
# macOS
export QT_MAC_WANTS_LAYER=1

# Linux
sudo apt-get install python3-pyqt6

# Windows
# ç¡®ä¿å®‰è£…äº†Visual C++ Redistributable
```

### æ€§èƒ½ä¼˜åŒ–

#### 1. æ¨¡å‹æ¨ç†ä¼˜åŒ–
```python
# ä½¿ç”¨åŠç²¾åº¦æ¨ç†
model.half()

# å¯ç”¨TensorRTä¼˜åŒ– (NVIDIA GPU)
model = torch.jit.script(model)
```

#### 2. å†…å­˜ç®¡ç†
```python
# åŠæ—¶æ¸…ç†GPUå†…å­˜
torch.cuda.empty_cache()

# ä½¿ç”¨å†…å­˜æ˜ å°„åŠ è½½å¤§æ–‡ä»¶
np.memmap(filename, dtype='float32', mode='r')
```

### æ—¥å¿—å’Œè°ƒè¯•

#### å¯ç”¨è¯¦ç»†æ—¥å¿—
```python
import logging
logging.basicConfig(level=logging.DEBUG)
```

#### æ€§èƒ½åˆ†æ
```python
import cProfile
cProfile.run('your_function()')
```

---

## ğŸ“ˆ æ›´æ–°æ—¥å¿—

### v2.0.0 (2024-10-25)
#### ğŸ‰ æ–°åŠŸèƒ½
- âœ… å®Œæ•´çš„æ‰¹é‡åˆ†æåŠŸèƒ½
- âœ… æ™ºèƒ½æ‰¹é‡ä¸‹è½½ç³»ç»Ÿ
- âœ… åˆ†æç»“æœç¼“å­˜æœºåˆ¶
- âœ… æ”¹è¿›çš„ç”¨æˆ·ç•Œé¢è®¾è®¡
- âœ… å¤šæ¨¡å‹æ”¯æŒ (YOLOv11, RT-DETR, DeepLabV3)

#### ğŸ”§ æ”¹è¿›
- ğŸ”„ ä¼˜åŒ–äº†æ¨¡å‹åŠ è½½æ€§èƒ½
- ğŸ”„ æ”¹è¿›äº†é”™è¯¯å¤„ç†æœºåˆ¶
- ğŸ”„ å¢å¼ºäº†ç»Ÿè®¡ä¿¡æ¯æ˜¾ç¤º
- ğŸ”„ ä¼˜åŒ–äº†å†…å­˜ä½¿ç”¨æ•ˆç‡

#### ğŸ› ä¿®å¤
- ğŸ”¨ ä¿®å¤äº†å•å¼ æ£€æµ‹æ˜¾ç¤ºé—®é¢˜
- ğŸ”¨ ä¿®å¤äº†æ‰¹é‡åˆ†æå¤±è´¥é—®é¢˜
- ğŸ”¨ ä¿®å¤äº†UIå“åº”æ€§é—®é¢˜
- ğŸ”¨ ä¿®å¤äº†æ–‡ä»¶è·¯å¾„å¤„ç†é—®é¢˜

### v1.0.0 (2024-09-15)
#### ğŸ‰ åˆå§‹ç‰ˆæœ¬
- âœ… åŸºç¡€è½¦è¾†æ£€æµ‹åŠŸèƒ½
- âœ… æ°´é¢åˆ†å‰²åŠŸèƒ½
- âœ… æ·¹æ²¡ç­‰çº§åˆ†æ
- âœ… æ¡Œé¢GUIåº”ç”¨
- âœ… åŸºç¡€Web API

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

### è”ç³»æ–¹å¼
- **é¡¹ç›®ä»“åº“**: [GitHub Repository]
- **é—®é¢˜åé¦ˆ**: [Issues Page]
- **æŠ€æœ¯æ–‡æ¡£**: [Documentation Site]

### è´¡çŒ®æŒ‡å—
1. Fork é¡¹ç›®ä»“åº“
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. åˆ›å»º Pull Request

### è®¸å¯è¯
æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶

---

## ğŸ™ è‡´è°¢

æ„Ÿè°¢ä»¥ä¸‹å¼€æºé¡¹ç›®å’ŒæŠ€æœ¯ç¤¾åŒºçš„æ”¯æŒï¼š
- [PyTorch](https://pytorch.org/) - æ·±åº¦å­¦ä¹ æ¡†æ¶
- [Ultralytics](https://ultralytics.com/) - YOLOv11å®ç°
- [PyQt6](https://www.riverbankcomputing.com/software/pyqt/) - GUIæ¡†æ¶
- [FastAPI](https://fastapi.tiangolo.com/) - Webæ¡†æ¶
- [OpenCV](https://opencv.org/) - è®¡ç®—æœºè§†è§‰åº“

---

*æœ€åæ›´æ–°: 2025å¹´10æœˆ25æ—¥*